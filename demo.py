#-*-coding:utf-8-*-

import requests
import xlwt
import random
import re


user_agent_list = [
             "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/22.0.1207.1 Safari/537.1",
             "Mozilla/5.0 (X11; CrOS i686 2268.111.0) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11",
             "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1092.0 Safari/536.6",
             "Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1090.0 Safari/536.6",
             "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/19.77.34.5 Safari/537.1",
             "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.9 Safari/536.5",
             "Mozilla/5.0 (Windows NT 6.0) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.36 Safari/536.5",
             "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1063.0 Safari/536.3",
             "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1063.0 Safari/536.3",
             "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_0) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1063.0 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1062.0 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1062.0 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1061.1 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1061.1 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1061.1 Safari/536.3",
             "Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.3 (KHTML, like Gecko) Chrome/19.0.1061.0 Safari/536.3",
             "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.24 (KHTML, like Gecko) Chrome/19.0.1055.1 Safari/535.24",
             "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/535.24 (KHTML, like Gecko) Chrome/19.0.1055.1 Safari/535.24"
            ]
file = open("urlweb.txt", 'r')
workbook = xlwt.Workbook()
sheet = workbook.add_sheet("Sheet1", cell_overwrite_ok=True)
i = 1

for url in file:
	try:
		user_agent = random.choice(user_agent_list)
		headers = {'User-Agent' : user_agent}
		r = requests.get(url = url, headers = headers)
		r.encoding = 'UTF-8'
		Title = re.findall('<title>(.*?)</title>', r.content)
		Type = re.findall('<title>.*?\s-\s(.*?)</title>', r.content)
		EDBID = re.findall('<td><strong>EDB-ID</strong>:.(.*?)</td>', r.content)
		Author = re.findall('<strong>Author</strong>:.<.*?>(.*?)</a>', r.content)
		Published = re.findall('<td><strong>Published</strong>:.(.*?)</td>', r.content)
		Platform = re.findall('<strong>Platform</strong>:.<.*?>(.*?)</a>', r.content)
		if EDBID:
			sheet.write(i, 0, EDBID[0])
		if Title:
			sheet.write(i, 1, Title[0])
			print i, Title[0]
		if Type:
			sheet.write(i, 2, Type[0])
		if Author:
			sheet.write(i, 3, Author[0])
		if Published:
			sheet.write(i, 4, Published[0])
		if Platform:
			sheet.write(i, 5, Platform[0])
		sheet.write(i, 6, url)
	except:
		print 'ERROR'
	i += 1
workbook.save("webexploits.xls")
file.close()
